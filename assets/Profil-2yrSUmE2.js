import{j as e}from"./vendor-charts-cvMpHz0W.js";import{r as d}from"./vendor-react-BdB5Pz3t.js";import{D as Q,u as V,a as G,C as h,h as f,i as g,n as b,B as m,g as j}from"./index-IaNwoOYO.js";import{I as v,S as i}from"./Input-BZ7duGHL.js";import{ah as P,aQ as H,X,am as $,aY as k,K as F,e as K,az as W,d as J,bE as A,t as Z,q as w,s as _,u as M,bF as ee,aW as ae}from"./vendor-icons-B6Rt7gcW.js";import"./vendor-export-C98UG4Mq.js";import"./vendor-utils-BBD155gO.js";function de(){const{profile:s,isLoading:R,loadProfile:Y,updateProfile:U,updatePreferences:q,setAvatar:S,setSignature:D,getFullName:se,getInitials:z}=Q(),{addToast:n}=V(),{centres:B}=G(),[c,N]=d.useState(!1),[r,o]=d.useState({nom:"",prenom:"",email:"",fonction:"",organisation:""}),E=d.useRef(null),I=d.useRef(null);d.useEffect(()=>{Y()},[]),d.useEffect(()=>{s&&o({nom:s.nom||"",prenom:s.prenom||"",email:s.email||"",fonction:s.fonction||"",organisation:s.organisation||""})},[s]);const L=async()=>{await U(r),N(!1),n({type:"success",title:"Profil mis à jour",message:"Vos informations ont été enregistrées"})},T=async a=>{var x;const l=(x=a.target.files)==null?void 0:x[0];if(!l)return;if(l.size>2*1024*1024){n({type:"error",title:"Fichier trop volumineux",message:"L'image doit faire moins de 2 MB"});return}const u=new FileReader;u.onload=async y=>{var p;const C=(p=y.target)==null?void 0:p.result;await S(C),n({type:"success",title:"Avatar mis à jour"})},u.readAsDataURL(l)},O=async a=>{var x;const l=(x=a.target.files)==null?void 0:x[0];if(!l)return;if(l.size>1*1024*1024){n({type:"error",title:"Fichier trop volumineux",message:"La signature doit faire moins de 1 MB"});return}const u=new FileReader;u.onload=async y=>{var p;const C=(p=y.target)==null?void 0:p.result;await D(C),n({type:"success",title:"Signature mise à jour"})},u.readAsDataURL(l)},t=async(a,l)=>{await q({[a]:l}),n({type:"success",title:"Préférence mise à jour"})};return R||!s?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-900"})}):e.jsxs("div",{className:"space-y-6 max-w-4xl",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-primary-900",children:"Mon Profil"}),e.jsx("p",{className:"text-primary-500 mt-1",children:"Gérez vos informations personnelles et préférences"})]}),e.jsxs(h,{children:[e.jsx(f,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(g,{className:"flex items-center gap-2",children:[e.jsx(P,{className:"w-5 h-5"}),"Informations Personnelles"]}),e.jsx(b,{children:"Vos informations apparaissent dans les rapports"})]}),c?e.jsxs("div",{className:"flex gap-2",children:[e.jsx(m,{variant:"secondary",onClick:()=>N(!1),leftIcon:e.jsx(X,{className:"w-4 h-4"}),children:"Annuler"}),e.jsx(m,{variant:"primary",onClick:L,leftIcon:e.jsx($,{className:"w-4 h-4"}),children:"Enregistrer"})]}):e.jsx(m,{variant:"secondary",onClick:()=>N(!0),leftIcon:e.jsx(H,{className:"w-4 h-4"}),children:"Modifier"})]})}),e.jsx(j,{children:e.jsxs("div",{className:"flex gap-8",children:[e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[s.avatar?e.jsx("img",{src:s.avatar,alt:"Avatar",className:"w-24 h-24 rounded-full object-cover border-2 border-primary-200"}):e.jsx("div",{className:"w-24 h-24 rounded-full bg-primary-100 flex items-center justify-center text-2xl font-bold text-primary-600",children:z()}),e.jsx("button",{onClick:()=>{var a;return(a=E.current)==null?void 0:a.click()},className:"absolute bottom-0 right-0 p-1.5 bg-primary-900 text-white rounded-full hover:bg-primary-800 transition-colors",children:e.jsx(k,{className:"w-4 h-4"})})]}),e.jsx("input",{ref:E,type:"file",accept:"image/*",onChange:T,className:"hidden"}),s.avatar&&e.jsxs("button",{onClick:()=>S(void 0),className:"text-sm text-danger hover:underline flex items-center gap-1",children:[e.jsx(F,{className:"w-3 h-3"}),"Supprimer"]})]}),e.jsxs("div",{className:"flex-1 grid grid-cols-2 gap-4",children:[e.jsx(v,{label:"Prénom",value:r.prenom,onChange:a=>o({...r,prenom:a.target.value}),disabled:!c,leftIcon:e.jsx(P,{className:"w-4 h-4"})}),e.jsx(v,{label:"Nom",value:r.nom,onChange:a=>o({...r,nom:a.target.value}),disabled:!c}),e.jsx(v,{label:"Email",type:"email",value:r.email,onChange:a=>o({...r,email:a.target.value}),disabled:!c,leftIcon:e.jsx(K,{className:"w-4 h-4"})}),e.jsx(v,{label:"Fonction",value:r.fonction,onChange:a=>o({...r,fonction:a.target.value}),disabled:!c,leftIcon:e.jsx(W,{className:"w-4 h-4"}),placeholder:"Ex: Directrice Générale Adjointe"}),e.jsx(v,{label:"Organisation",value:r.organisation,onChange:a=>o({...r,organisation:a.target.value}),disabled:!c,leftIcon:e.jsx(J,{className:"w-4 h-4"}),className:"col-span-2"})]})]})})]}),e.jsxs(h,{children:[e.jsxs(f,{children:[e.jsxs(g,{className:"flex items-center gap-2",children:[e.jsx(A,{className:"w-5 h-5"}),"Préférences d'Affichage"]}),e.jsx(b,{children:"Personnalisez l'interface de l'application"})]}),e.jsx(j,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-primary-700 mb-3",children:"Thème"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>t("theme","light"),className:`flex items-center gap-2 px-4 py-2 rounded-btn border transition-all ${s.preferences.theme==="light"?"border-primary-900 bg-primary-50":"border-primary-200 hover:border-primary-300"}`,children:[e.jsx(Z,{className:"w-4 h-4"}),"Clair",s.preferences.theme==="light"&&e.jsx(w,{className:"w-4 h-4 text-success"})]}),e.jsxs("button",{onClick:()=>t("theme","dark"),className:`flex items-center gap-2 px-4 py-2 rounded-btn border transition-all ${s.preferences.theme==="dark"?"border-primary-900 bg-primary-50":"border-primary-200 hover:border-primary-300"}`,children:[e.jsx(_,{className:"w-4 h-4"}),"Sombre",s.preferences.theme==="dark"&&e.jsx(w,{className:"w-4 h-4 text-success"})]}),e.jsxs("button",{onClick:()=>t("theme","system"),className:`flex items-center gap-2 px-4 py-2 rounded-btn border transition-all ${s.preferences.theme==="system"?"border-primary-900 bg-primary-50":"border-primary-200 hover:border-primary-300"}`,children:[e.jsx(A,{className:"w-4 h-4"}),"Système",s.preferences.theme==="system"&&e.jsx(w,{className:"w-4 h-4 text-success"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(i,{label:"Langue",value:s.preferences.langue,onChange:a=>t("langue",a.target.value),options:[{value:"fr",label:"Français"},{value:"en",label:"English"}]}),e.jsx(i,{label:"Format de date",value:s.preferences.formatDate,onChange:a=>t("formatDate",a.target.value),options:[{value:"DD/MM/YYYY",label:"31/01/2026"},{value:"YYYY-MM-DD",label:"2026-01-31"},{value:"MM/DD/YYYY",label:"01/31/2026"}]}),e.jsx(i,{label:"Devise par défaut",value:s.preferences.deviseDefaut,onChange:a=>t("deviseDefaut",a.target.value),options:[{value:"XOF",label:"XOF - Franc CFA"},{value:"EUR",label:"EUR - Euro"},{value:"USD",label:"USD - Dollar US"}]})]}),e.jsx("div",{children:e.jsx(i,{label:"Centre affiché au démarrage",value:s.preferences.centreParDefaut||"",onChange:a=>t("centreParDefaut",a.target.value||void 0),options:[{value:"",label:"Dashboard global"},...B.map(a=>({value:a.id,label:a.nom}))]})})]})})]}),e.jsxs(h,{children:[e.jsxs(f,{children:[e.jsxs(g,{className:"flex items-center gap-2",children:[e.jsx(M,{className:"w-5 h-5"}),"Notifications"]}),e.jsx(b,{children:"Configurez les alertes par email"})]}),e.jsx(j,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-primary-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[s.preferences.notificationsEmail?e.jsx(M,{className:"w-5 h-5 text-success"}):e.jsx(ee,{className:"w-5 h-5 text-primary-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-primary-900",children:"Notifications par email"}),e.jsx("p",{className:"text-sm text-primary-500",children:s.preferences.notificationsEmail?"Vous recevrez des alertes par email":"Les notifications email sont désactivées"})]})]}),e.jsx(m,{variant:s.preferences.notificationsEmail?"secondary":"primary",onClick:()=>t("notificationsEmail",!s.preferences.notificationsEmail),children:s.preferences.notificationsEmail?"Désactiver":"Activer"})]}),s.preferences.notificationsEmail&&e.jsx(i,{label:"Fréquence du digest",value:s.preferences.digestFrequence,onChange:a=>t("digestFrequence",a.target.value),options:[{value:"quotidien",label:"Quotidien (chaque soir)"},{value:"hebdomadaire",label:"Hebdomadaire (lundi matin)"},{value:"jamais",label:"Uniquement alertes critiques"}]})]})})]}),e.jsxs(h,{children:[e.jsxs(f,{children:[e.jsxs(g,{className:"flex items-center gap-2",children:[e.jsx(ae,{className:"w-5 h-5"}),"Signature pour Rapports"]}),e.jsx(b,{children:"Votre signature apparaîtra sur les rapports exportés"})]}),e.jsxs(j,{children:[e.jsxs("div",{className:"flex items-start gap-6",children:[e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"p-4 border-2 border-dashed border-primary-200 rounded-lg bg-white min-h-[100px] flex items-center justify-center",children:s.signature?e.jsx("img",{src:s.signature,alt:"Signature",className:"max-h-20 object-contain"}):e.jsx("p",{className:"text-primary-400 text-sm",children:"Aucune signature définie"})})}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("input",{ref:I,type:"file",accept:"image/*",onChange:O,className:"hidden"}),e.jsx(m,{variant:"secondary",onClick:()=>{var a;return(a=I.current)==null?void 0:a.click()},leftIcon:e.jsx(k,{className:"w-4 h-4"}),children:s.signature?"Changer":"Importer"}),s.signature&&e.jsx(m,{variant:"danger",onClick:()=>D(void 0),leftIcon:e.jsx(F,{className:"w-4 h-4"}),children:"Supprimer"})]})]}),e.jsx("p",{className:"mt-3 text-xs text-primary-400",children:"Conseil: Utilisez une image PNG avec fond transparent pour un meilleur rendu."})]})]}),e.jsxs(h,{children:[e.jsx(f,{children:e.jsx(g,{children:"Options d'Export"})}),e.jsx(j,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(i,{label:"Qualité des exports",value:s.preferences.exportQualite,onChange:a=>t("exportQualite",a.target.value),options:[{value:"standard",label:"Standard (fichiers plus légers)"},{value:"haute",label:"Haute qualité (meilleur rendu)"}]}),e.jsx(i,{label:"Intervalle de sauvegarde auto (Report Studio)",value:String(s.preferences.autoSaveInterval),onChange:a=>t("autoSaveInterval",parseInt(a.target.value)),options:[{value:"15",label:"Toutes les 15 secondes"},{value:"30",label:"Toutes les 30 secondes"},{value:"60",label:"Toutes les minutes"},{value:"120",label:"Toutes les 2 minutes"}]})]})})]})]})}export{de as Profil};
