import{j as s}from"./vendor-charts-cvMpHz0W.js";import{r as n}from"./vendor-react-BdB5Pz3t.js";import{e as k,a as I,B as i,C as o,g as m}from"./index-IaNwoOYO.js";import{B as u}from"./Badge-CM23X0aP.js";import{S as x}from"./Input-BZ7duGHL.js";import{K as d,y as h,q as B,u as P,I as _,A as z,x as E}from"./vendor-icons-B6Rt7gcW.js";import{f}from"./vendor-utils-BBD155gO.js";import{f as H}from"./fr-C0qvdQu_.js";import"./vendor-export-C98UG4Mq.js";function O(){const{alertes:r,loadAlertes:p,marquerCommeLue:j,marquerCommeTraitee:N,supprimerAlerte:v,supprimerAlertesTraitees:g}=k(),{centres:y}=I(),[a,C]=n.useState("all"),[t,b]=n.useState("all");n.useEffect(()=>{p()},[]);const c=r.filter(e=>!(a!=="all"&&e.priorite!==a||t==="non_lues"&&e.lue||t==="non_traitees"&&e.traitee||t==="traitees"&&!e.traitee)),w=r.filter(e=>!e.lue).length,T=r.filter(e=>!e.traitee).length,A=e=>{switch(e){case"critique":return s.jsx(E,{className:"w-5 h-5 text-error"});case"haute":return s.jsx(z,{className:"w-5 h-5 text-warning"});case"normale":return s.jsx(_,{className:"w-5 h-5 text-info"});default:return s.jsx(P,{className:"w-5 h-5 text-primary-400"})}},S=e=>{switch(e){case"critique":return"error";case"haute":return"warning";case"normale":return"info";default:return"default"}},q=e=>{if(!e)return"Global";const l=y.find(M=>M.id===e);return(l==null?void 0:l.code)||"Inconnu"};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-primary-900",children:"Alertes"}),s.jsxs("p",{className:"text-primary-500 mt-1",children:[w," non lue(s) · ",T," à traiter"]})]}),s.jsx("div",{className:"flex items-center gap-3",children:s.jsxs(i,{variant:"ghost",onClick:g,disabled:!r.some(e=>e.traitee),children:[s.jsx(d,{className:"w-4 h-4 mr-2"}),"Supprimer traitées"]})})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(x,{options:[{value:"all",label:"Toutes les priorités"},{value:"critique",label:"Critique"},{value:"haute",label:"Haute"},{value:"normale",label:"Normale"},{value:"info",label:"Info"}],value:a,onChange:e=>C(e.target.value),className:"w-48"}),s.jsx(x,{options:[{value:"all",label:"Tous les statuts"},{value:"non_lues",label:"Non lues"},{value:"non_traitees",label:"Non traitées"},{value:"traitees",label:"Traitées"}],value:t,onChange:e=>b(e.target.value),className:"w-48"})]}),c.length===0?s.jsx(o,{children:s.jsxs(m,{className:"text-center py-12",children:[s.jsx(h,{className:"w-12 h-12 text-success mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-primary-900 mb-2",children:"Aucune alerte"}),s.jsx("p",{className:"text-primary-500",children:t!=="all"||a!=="all"?"Aucune alerte ne correspond aux filtres sélectionnés":"Toutes les alertes ont été traitées"})]})}):s.jsx("div",{className:"space-y-3",children:c.map(e=>s.jsx(o,{className:`transition-all ${e.lue?"":"border-l-4 border-l-info bg-info/5"} ${e.traitee?"opacity-60":""}`,children:s.jsxs(m,{className:"flex items-start gap-4 py-4",children:[s.jsx("div",{className:"mt-1",children:A(e.priorite)}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("h3",{className:`font-medium ${e.lue?"text-primary-700":"text-primary-900"}`,children:e.titre}),s.jsx(u,{variant:S(e.priorite),children:e.priorite}),e.centreId&&s.jsx(u,{children:q(e.centreId)})]}),s.jsx("p",{className:"text-sm text-primary-500",children:e.message}),s.jsxs("p",{className:"text-xs text-primary-400 mt-2",children:[f(new Date(e.dateCreation),"dd MMMM yyyy à HH:mm",{locale:H}),e.dateTraitement&&s.jsxs("span",{className:"ml-2",children:["· Traitée le ",f(new Date(e.dateTraitement),"dd/MM/yyyy")]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[!e.lue&&s.jsx(i,{variant:"ghost",size:"sm",onClick:()=>j(e.id),title:"Marquer comme lue",children:s.jsx(B,{className:"w-4 h-4"})}),!e.traitee&&s.jsxs(i,{variant:"secondary",size:"sm",onClick:()=>N(e.id),children:[s.jsx(h,{className:"w-4 h-4 mr-1"}),"Traiter"]}),s.jsx(i,{variant:"ghost",size:"sm",onClick:()=>v(e.id),title:"Supprimer",children:s.jsx(d,{className:"w-4 h-4 text-error"})})]})]})},e.id))})]})}export{O as Alertes};
