import{j as e}from"./vendor-charts-cvMpHz0W.js";import{e as ae,r as a,L as T}from"./vendor-react-BdB5Pz3t.js";import{u as le,f as ie}from"./index-IaNwoOYO.js";import{a5 as ne,ab as ce,A as I,x as oe,a7 as de,ay as D,g as F,ar as xe,a8 as me,r as pe,aY as ue,_,D as he,X as P}from"./vendor-icons-B6Rt7gcW.js";import{d as L,p as k,f as o}from"./vendor-utils-BBD155gO.js";import{f as ye}from"./fr-C0qvdQu_.js";import"./vendor-export-C98UG4Mq.js";function Ce(){const{centreId:d}=ae(),{setCurrentCentre:E,addToast:u}=le(),{projets:V,reserves:i,documentsDOE:x,loadProjet:R,loadDOE:q,addReserve:B,updateReserve:z,addDocumentDOE:H,updateDocumentDOE:v}=ie(),[m,O]=a.useState("doe"),[M,U]=a.useState("all"),[S,G]=a.useState("all"),[y,X]=a.useState("all"),[j,Y]=a.useState(""),[Z,h]=a.useState(!1),[J,f]=a.useState(!1),[b,N]=a.useState(null),[g,w]=a.useState(null),[n,C]=a.useState(null);a.useEffect(()=>{d&&(E(d),R(d))},[d,E,R]);const c=V.find(t=>t.centreId===d);a.useEffect(()=>{c&&q(c.id)},[c,q]);const K=[...new Set(i.map(t=>t.lot))].sort(),Q=[...new Set(x.map(t=>t.lot))].sort(),$=i.filter(t=>{if(M!=="all"&&t.classification!==M||S!=="all"&&t.statut!==S||y!=="all"&&t.lot!==y)return!1;if(j){const s=j.toLowerCase();return t.numero.toLowerCase().includes(s)||t.description.toLowerCase().includes(s)||t.localisation.toLowerCase().includes(s)}return!0}),A=x.filter(t=>{if(y!=="all"&&t.lot!==y)return!1;if(j){const s=j.toLowerCase();return t.description.toLowerCase().includes(s)||t.type.toLowerCase().includes(s)||t.lot.toLowerCase().includes(s)}return!0}),l={totalReserves:i.length,bloquantes:i.filter(t=>t.classification==="bloquante"&&t.statut!=="levee").length,majeures:i.filter(t=>t.classification==="majeure"&&t.statut!=="levee").length,mineures:i.filter(t=>t.classification==="mineure"&&t.statut!=="levee").length,levees:i.filter(t=>t.statut==="levee").length,enRetard:i.filter(t=>t.statut==="levee"?!1:L(new Date,k(t.dateLimite))>0).length,docsTotal:x.length,docsRecus:x.filter(t=>t.recu).length,docsVerifies:x.filter(t=>t.verifie).length,docsConformes:x.filter(t=>t.conforme).length,docsManquants:x.filter(t=>t.obligatoire&&!t.recu).length},W=t=>{switch(t){case"bloquante":return"bg-error/10 text-error border-error/20";case"majeure":return"bg-warning/10 text-warning border-warning/20";case"mineure":return"bg-info/10 text-info border-info/20"}},ee=t=>{switch(t){case"ouverte":return"bg-error/10 text-error";case"en_cours":return"bg-warning/10 text-warning";case"levee":return"bg-success/10 text-success";case"contestee":return"bg-purple-100 text-purple-700"}},te=t=>{switch(t){case"ouverte":return"Ouverte";case"en_cours":return"En cours";case"levee":return"Levée";case"contestee":return"Contestée"}},re=()=>{const[t,s]=a.useState(b||{numero:`R-${String(i.length+1).padStart(3,"0")}`,lot:(n==null?void 0:n.lot)||"",localisation:"",description:n?`Non-conformité sur: ${n.description}`:"",classification:"mineure",dateIdentification:o(new Date,"yyyy-MM-dd"),dateLimite:o(new Date(Date.now()+12096e5),"yyyy-MM-dd"),responsableEntreprise:"",statut:"ouverte",photos:[],documentDOEId:n==null?void 0:n.id}),p=async r=>{if(r.preventDefault(),!!c)try{b?(await z(b.id,t),u({type:"success",title:"Réserve mise à jour"})):(await B({...t,projetId:c.id}),u({type:"success",title:"Réserve créée"})),h(!1),N(null),C(null)}catch{u({type:"error",title:"Erreur lors de la sauvegarde"})}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b border-primary-200 px-6 py-4 flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold text-primary-900",children:b?"Modifier la réserve":"Nouvelle réserve"}),e.jsx("button",{onClick:()=>{h(!1),N(null),C(null)},className:"p-2 hover:bg-primary-100 rounded-lg",children:e.jsx(P,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:p,className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-primary-700 mb-1",children:"Numéro"}),e.jsx("input",{type:"text",value:t.numero||"",onChange:r=>s({...t,numero:r.target.value}),className:"w-full px-3 py-2 border border-primary-200 rounded-lg",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-primary-700 mb-1",children:"Lot"}),e.jsx("input",{type:"text",value:t.lot||"",onChange:r=>s({...t,lot:r.target.value}),className:"w-full px-3 py-2 border border-primary-200 rounded-lg",placeholder:"ex: Électricité, Plomberie...",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-primary-700 mb-1",children:"Localisation"}),e.jsx("input",{type:"text",value:t.localisation||"",onChange:r=>s({...t,localisation:r.target.value}),className:"w-full px-3 py-2 border border-primary-200 rounded-lg",placeholder:"ex: RDC - Zone A - Local 12",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-primary-700 mb-1",children:"Description"}),e.jsx("textarea",{value:t.description||"",onChange:r=>s({...t,description:r.target.value}),className:"w-full px-3 py-2 border border-primary-200 rounded-lg",rows:3,required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-primary-700 mb-1",children:"Classification"}),e.jsxs("select",{value:t.classification||"mineure",onChange:r=>s({...t,classification:r.target.value}),className:"w-full px-3 py-2 border border-primary-200 rounded-lg",children:[e.jsx("option",{value:"bloquante",children:"Bloquante"}),e.jsx("option",{value:"majeure",children:"Majeure"}),e.jsx("option",{value:"mineure",children:"Mineure"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-primary-700 mb-1",children:"Statut"}),e.jsxs("select",{value:t.statut||"ouverte",onChange:r=>s({...t,statut:r.target.value,dateLevee:r.target.value==="levee"?o(new Date,"yyyy-MM-dd"):void 0}),className:"w-full px-3 py-2 border border-primary-200 rounded-lg",children:[e.jsx("option",{value:"ouverte",children:"Ouverte"}),e.jsx("option",{value:"en_cours",children:"En cours"}),e.jsx("option",{value:"levee",children:"Levée"}),e.jsx("option",{value:"contestee",children:"Contestée"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-primary-700 mb-1",children:"Date identification"}),e.jsx("input",{type:"date",value:t.dateIdentification||"",onChange:r=>s({...t,dateIdentification:r.target.value}),className:"w-full px-3 py-2 border border-primary-200 rounded-lg",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-primary-700 mb-1",children:"Date limite"}),e.jsx("input",{type:"date",value:t.dateLimite||"",onChange:r=>s({...t,dateLimite:r.target.value}),className:"w-full px-3 py-2 border border-primary-200 rounded-lg",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-primary-700 mb-1",children:"Entreprise responsable"}),e.jsx("input",{type:"text",value:t.responsableEntreprise||"",onChange:r=>s({...t,responsableEntreprise:r.target.value}),className:"w-full px-3 py-2 border border-primary-200 rounded-lg",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-primary-700 mb-1",children:"Commentaire"}),e.jsx("textarea",{value:t.commentaire||"",onChange:r=>s({...t,commentaire:r.target.value}),className:"w-full px-3 py-2 border border-primary-200 rounded-lg",rows:2})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>{h(!1),N(null),C(null)},className:"px-4 py-2 text-primary-700 hover:bg-primary-100 rounded-lg",children:"Annuler"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-primary-900 text-white rounded-lg hover:bg-primary-800",children:b?"Mettre à jour":"Créer"})]})]})]})})},se=()=>{const[t,s]=a.useState(g||{lot:"",type:"",description:"",obligatoire:!0,recu:!1,verifie:!1,conforme:!1}),p=async r=>{if(r.preventDefault(),!!c)try{g?(await v(g.id,t),u({type:"success",title:"Document mis à jour"})):(await H({...t,projetId:c.id}),u({type:"success",title:"Document ajouté"})),f(!1),w(null)}catch{u({type:"error",title:"Erreur lors de la sauvegarde"})}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-lg w-full",children:[e.jsxs("div",{className:"border-b border-primary-200 px-6 py-4 flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold text-primary-900",children:g?"Modifier le document":"Nouveau document DOE"}),e.jsx("button",{onClick:()=>{f(!1),w(null)},className:"p-2 hover:bg-primary-100 rounded-lg",children:e.jsx(P,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:p,className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-primary-700 mb-1",children:"Lot"}),e.jsx("input",{type:"text",value:t.lot||"",onChange:r=>s({...t,lot:r.target.value}),className:"w-full px-3 py-2 border border-primary-200 rounded-lg",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-primary-700 mb-1",children:"Type"}),e.jsxs("select",{value:t.type||"",onChange:r=>s({...t,type:r.target.value}),className:"w-full px-3 py-2 border border-primary-200 rounded-lg",required:!0,children:[e.jsx("option",{value:"",children:"Sélectionner..."}),e.jsx("option",{value:"plans_recollement",children:"Plans de recollement"}),e.jsx("option",{value:"notices_techniques",children:"Notices techniques"}),e.jsx("option",{value:"pv_essais",children:"PV d'essais"}),e.jsx("option",{value:"certificats",children:"Certificats"}),e.jsx("option",{value:"garanties",children:"Garanties"}),e.jsx("option",{value:"fiches_techniques",children:"Fiches techniques"}),e.jsx("option",{value:"manuels",children:"Manuels d'utilisation"}),e.jsx("option",{value:"autre",children:"Autre"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-primary-700 mb-1",children:"Description"}),e.jsx("textarea",{value:t.description||"",onChange:r=>s({...t,description:r.target.value}),className:"w-full px-3 py-2 border border-primary-200 rounded-lg",rows:2,required:!0})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:t.obligatoire||!1,onChange:r=>s({...t,obligatoire:r.target.checked}),className:"w-4 h-4 rounded border-primary-300 text-primary-900 focus:ring-primary-500"}),e.jsx("span",{className:"text-sm text-primary-700",children:"Document obligatoire"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:t.recu||!1,onChange:r=>s({...t,recu:r.target.checked,dateReception:r.target.checked?o(new Date,"yyyy-MM-dd"):void 0}),className:"w-4 h-4 rounded border-primary-300 text-primary-900 focus:ring-primary-500"}),e.jsx("span",{className:"text-sm text-primary-700",children:"Reçu"})]}),t.recu&&e.jsxs(e.Fragment,{children:[e.jsxs("label",{className:"flex items-center gap-2 ml-6",children:[e.jsx("input",{type:"checkbox",checked:t.verifie||!1,onChange:r=>s({...t,verifie:r.target.checked,dateVerification:r.target.checked?o(new Date,"yyyy-MM-dd"):void 0}),className:"w-4 h-4 rounded border-primary-300 text-primary-900 focus:ring-primary-500"}),e.jsx("span",{className:"text-sm text-primary-700",children:"Vérifié"})]}),t.verifie&&e.jsxs("label",{className:"flex items-center gap-2 ml-6",children:[e.jsx("input",{type:"checkbox",checked:t.conforme||!1,onChange:r=>s({...t,conforme:r.target.checked}),className:"w-4 h-4 rounded border-primary-300 text-primary-900 focus:ring-primary-500"}),e.jsx("span",{className:"text-sm text-primary-700",children:"Conforme"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-primary-700 mb-1",children:"Commentaire"}),e.jsx("textarea",{value:t.commentaire||"",onChange:r=>s({...t,commentaire:r.target.value}),className:"w-full px-3 py-2 border border-primary-200 rounded-lg",rows:2})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>{f(!1),w(null)},className:"px-4 py-2 text-primary-700 hover:bg-primary-100 rounded-lg",children:"Annuler"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-primary-900 text-white rounded-lg hover:bg-primary-800",children:g?"Mettre à jour":"Ajouter"})]})]})]})})};return c?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(T,{to:`/centre/${d}/projet`,className:"p-2 hover:bg-primary-100 rounded-lg transition-colors",children:e.jsx(ne,{className:"w-5 h-5 text-primary-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-display font-bold text-primary-900",children:"Handover Technique"}),e.jsx("p",{className:"text-primary-500",children:"Réserves et DOE"})]})]}),e.jsxs("button",{onClick:()=>m==="reserves"?h(!0):f(!0),className:"flex items-center gap-2 px-4 py-2 bg-primary-900 text-white rounded-lg hover:bg-primary-800",children:[e.jsx(ce,{className:"w-4 h-4"}),m==="reserves"?"Nouvelle réserve":"Nouveau document"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-xl p-4 border border-primary-200",children:[e.jsxs("div",{className:"flex items-center gap-2 text-primary-500 mb-1",children:[e.jsx(I,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"Bloquantes"})]}),e.jsx("p",{className:`text-2xl font-bold ${l.bloquantes>0?"text-error":"text-success"}`,children:l.bloquantes})]}),e.jsxs("div",{className:"bg-white rounded-xl p-4 border border-primary-200",children:[e.jsxs("div",{className:"flex items-center gap-2 text-primary-500 mb-1",children:[e.jsx(oe,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"Majeures"})]}),e.jsx("p",{className:`text-2xl font-bold ${l.majeures>0?"text-warning":"text-success"}`,children:l.majeures})]}),e.jsxs("div",{className:"bg-white rounded-xl p-4 border border-primary-200",children:[e.jsxs("div",{className:"flex items-center gap-2 text-primary-500 mb-1",children:[e.jsx(de,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"En retard"})]}),e.jsx("p",{className:`text-2xl font-bold ${l.enRetard>0?"text-error":"text-success"}`,children:l.enRetard})]}),e.jsxs("div",{className:"bg-white rounded-xl p-4 border border-primary-200",children:[e.jsxs("div",{className:"flex items-center gap-2 text-primary-500 mb-1",children:[e.jsx(D,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"Levées"})]}),e.jsx("p",{className:"text-2xl font-bold text-success",children:l.levees}),e.jsxs("p",{className:"text-xs text-primary-400",children:["/ ",l.totalReserves]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-4 border border-primary-200",children:[e.jsxs("div",{className:"flex items-center gap-2 text-primary-500 mb-1",children:[e.jsx(F,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"DOE reçus"})]}),e.jsx("p",{className:"text-2xl font-bold text-primary-900",children:l.docsRecus}),e.jsxs("p",{className:"text-xs text-primary-400",children:["/ ",l.docsTotal]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-4 border border-primary-200",children:[e.jsxs("div",{className:"flex items-center gap-2 text-primary-500 mb-1",children:[e.jsx(xe,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"DOE manquants"})]}),e.jsx("p",{className:`text-2xl font-bold ${l.docsManquants>0?"text-error":"text-success"}`,children:l.docsManquants})]})]}),e.jsx("div",{className:"bg-white rounded-xl border border-primary-200 p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>O("reserves"),className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-colors ${m==="reserves"?"bg-primary-900 text-white":"bg-primary-100 text-primary-700 hover:bg-primary-200"}`,children:[e.jsx(me,{className:"w-4 h-4"}),"Réserves"]}),e.jsxs("button",{onClick:()=>O("doe"),className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-colors ${m==="doe"?"bg-primary-900 text-white":"bg-primary-100 text-primary-700 hover:bg-primary-200"}`,children:[e.jsx(F,{className:"w-4 h-4"}),"DOE"]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(pe,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-primary-400"}),e.jsx("input",{type:"text",placeholder:"Rechercher...",value:j,onChange:t=>Y(t.target.value),className:"pl-10 pr-4 py-2 border border-primary-200 rounded-lg text-sm w-48"})]}),m==="reserves"&&e.jsxs(e.Fragment,{children:[e.jsxs("select",{value:M,onChange:t=>U(t.target.value),className:"px-3 py-2 border border-primary-200 rounded-lg text-sm",children:[e.jsx("option",{value:"all",children:"Toutes classifications"}),e.jsx("option",{value:"bloquante",children:"Bloquantes"}),e.jsx("option",{value:"majeure",children:"Majeures"}),e.jsx("option",{value:"mineure",children:"Mineures"})]}),e.jsxs("select",{value:S,onChange:t=>G(t.target.value),className:"px-3 py-2 border border-primary-200 rounded-lg text-sm",children:[e.jsx("option",{value:"all",children:"Tous statuts"}),e.jsx("option",{value:"ouverte",children:"Ouvertes"}),e.jsx("option",{value:"en_cours",children:"En cours"}),e.jsx("option",{value:"levee",children:"Levées"}),e.jsx("option",{value:"contestee",children:"Contestées"})]})]}),e.jsxs("select",{value:y,onChange:t=>X(t.target.value),className:"px-3 py-2 border border-primary-200 rounded-lg text-sm",children:[e.jsx("option",{value:"all",children:"Tous les lots"}),(m==="reserves"?K:Q).map(t=>e.jsx("option",{value:t,children:t},t))]})]})]})}),m==="reserves"?e.jsx("div",{className:"bg-white rounded-xl border border-primary-200 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-primary-50 border-b border-primary-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-4 py-3 text-xs font-medium text-primary-500 uppercase",children:"N°"}),e.jsx("th",{className:"text-left px-4 py-3 text-xs font-medium text-primary-500 uppercase",children:"Lot"}),e.jsx("th",{className:"text-left px-4 py-3 text-xs font-medium text-primary-500 uppercase",children:"Localisation"}),e.jsx("th",{className:"text-left px-4 py-3 text-xs font-medium text-primary-500 uppercase",children:"Description"}),e.jsx("th",{className:"text-left px-4 py-3 text-xs font-medium text-primary-500 uppercase",children:"Classification"}),e.jsx("th",{className:"text-left px-4 py-3 text-xs font-medium text-primary-500 uppercase",children:"Date limite"}),e.jsx("th",{className:"text-left px-4 py-3 text-xs font-medium text-primary-500 uppercase",children:"Entreprise"}),e.jsx("th",{className:"text-left px-4 py-3 text-xs font-medium text-primary-500 uppercase",children:"Statut"}),e.jsx("th",{className:"px-4 py-3"})]})}),e.jsx("tbody",{className:"divide-y divide-primary-100",children:$.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:"px-4 py-8 text-center text-primary-500",children:"Aucune réserve trouvée"})}):$.map(t=>{const s=t.statut!=="levee"&&L(new Date,k(t.dateLimite))>0;return e.jsxs("tr",{className:"hover:bg-primary-50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"font-mono text-sm font-medium",children:t.numero})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:t.lot}),e.jsx("td",{className:"px-4 py-3 text-sm",children:t.localisation}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("p",{className:"text-sm text-primary-700 line-clamp-2",children:t.description})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium border ${W(t.classification)}`,children:t.classification.charAt(0).toUpperCase()+t.classification.slice(1)})}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("span",{className:`text-sm ${s?"text-error font-medium":"text-primary-600"}`,children:o(k(t.dateLimite),"dd MMM yyyy",{locale:ye})}),s&&e.jsxs("span",{className:"block text-xs text-error",children:[L(new Date,k(t.dateLimite)),"j de retard"]})]}),e.jsx("td",{className:"px-4 py-3 text-sm",children:t.responsableEntreprise}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${ee(t.statut)}`,children:te(t.statut)})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-1",children:[t.photos.length>0&&e.jsx("button",{className:"p-1.5 hover:bg-primary-100 rounded-lg",children:e.jsx(ue,{className:"w-4 h-4 text-primary-500"})}),e.jsx("button",{onClick:()=>{N(t),h(!0)},className:"p-1.5 hover:bg-primary-100 rounded-lg",children:e.jsx(_,{className:"w-4 h-4 text-primary-500"})})]})})]},t.id)})})]})})}):e.jsx("div",{className:"bg-white rounded-xl border border-primary-200 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-primary-50 border-b border-primary-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-4 py-3 text-xs font-medium text-primary-500 uppercase",children:"Lot"}),e.jsx("th",{className:"text-left px-4 py-3 text-xs font-medium text-primary-500 uppercase",children:"Type"}),e.jsx("th",{className:"text-left px-4 py-3 text-xs font-medium text-primary-500 uppercase",children:"Description"}),e.jsx("th",{className:"text-center px-4 py-3 text-xs font-medium text-primary-500 uppercase",children:"Obligatoire"}),e.jsx("th",{className:"text-center px-4 py-3 text-xs font-medium text-primary-500 uppercase",children:"Reçu"}),e.jsx("th",{className:"text-center px-4 py-3 text-xs font-medium text-primary-500 uppercase",children:"Vérifié"}),e.jsx("th",{className:"text-center px-4 py-3 text-xs font-medium text-primary-500 uppercase",children:"Conforme"}),e.jsx("th",{className:"text-center px-4 py-3 text-xs font-medium text-primary-500 uppercase",children:"Réserves"}),e.jsx("th",{className:"px-4 py-3 text-xs font-medium text-primary-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-primary-100",children:A.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:"px-4 py-8 text-center text-primary-500",children:"Aucun document trouvé"})}):A.map(t=>{const s=i.filter(r=>r.documentDOEId===t.id),p=s.filter(r=>r.statut!=="levee");return e.jsxs("tr",{className:"hover:bg-primary-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium",children:t.lot}),e.jsx("td",{className:"px-4 py-3 text-sm",children:t.type.replace(/_/g," ").replace(/\b\w/g,r=>r.toUpperCase())}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("p",{className:"text-sm text-primary-700",children:t.description})}),e.jsx("td",{className:"px-4 py-3 text-center",children:t.obligatoire?e.jsx("span",{className:"px-2 py-1 bg-warning/10 text-warning rounded-full text-xs",children:"Oui"}):e.jsx("span",{className:"text-primary-400 text-sm",children:"-"})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx("button",{onClick:async()=>{await v(t.id,{recu:!t.recu,dateReception:t.recu?void 0:o(new Date,"yyyy-MM-dd")})},className:`w-6 h-6 rounded border-2 flex items-center justify-center transition-colors ${t.recu?"bg-success border-success text-white":"border-primary-300 hover:border-primary-400"}`,children:t.recu&&e.jsx(D,{className:"w-4 h-4"})})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx("button",{onClick:async()=>{t.recu&&await v(t.id,{verifie:!t.verifie,dateVerification:t.verifie?void 0:o(new Date,"yyyy-MM-dd")})},disabled:!t.recu,className:`w-6 h-6 rounded border-2 flex items-center justify-center transition-colors ${t.verifie?"bg-info border-info text-white":t.recu?"border-primary-300 hover:border-primary-400":"border-primary-200 bg-primary-50 cursor-not-allowed"}`,children:t.verifie&&e.jsx(D,{className:"w-4 h-4"})})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx("button",{onClick:async()=>{t.verifie&&await v(t.id,{conforme:!t.conforme})},disabled:!t.verifie,className:`w-6 h-6 rounded border-2 flex items-center justify-center transition-colors ${t.conforme?"bg-success border-success text-white":t.verifie?"border-primary-300 hover:border-primary-400":"border-primary-200 bg-primary-50 cursor-not-allowed"}`,children:t.conforme&&e.jsx(D,{className:"w-4 h-4"})})}),e.jsx("td",{className:"px-4 py-3 text-center",children:s.length>0?e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${p.length>0?"bg-error/10 text-error":"bg-success/10 text-success"}`,children:p.length>0?`${p.length} ouverte(s)`:`${s.length} levée(s)`}):e.jsx("span",{className:"text-primary-400 text-sm",children:"-"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("button",{onClick:()=>{C(t),h(!0)},className:"flex items-center gap-1 px-2 py-1 text-xs font-medium text-warning bg-warning/10 hover:bg-warning/20 rounded-lg transition-colors",title:"Ajouter une réserve",children:[e.jsx(I,{className:"w-3 h-3"}),"Réserve"]}),t.fichierId&&e.jsx("button",{className:"p-1.5 hover:bg-primary-100 rounded-lg",children:e.jsx(he,{className:"w-4 h-4 text-primary-500"})}),e.jsx("button",{onClick:()=>{w(t),f(!0)},className:"p-1.5 hover:bg-primary-100 rounded-lg",children:e.jsx(_,{className:"w-4 h-4 text-primary-500"})})]})})]},t.id)})})]})})}),Z&&e.jsx(re,{}),J&&e.jsx(se,{})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-64",children:[e.jsx("p",{className:"text-primary-500",children:"Aucun projet trouvé pour ce centre"}),e.jsx(T,{to:`/centre/${d}/projet`,className:"mt-4 text-primary-700 hover:underline",children:"Retour au tableau de bord projet"})]})}export{Ce as ProjetHandover};
