import{j as e}from"./vendor-charts-cvMpHz0W.js";import{e as oe,d as xe,r as j}from"./vendor-react-BdB5Pz3t.js";import{a as me,f as de,B as S,C as i,g as n,h as B,i as E}from"./index-IaNwoOYO.js";import{B as ue}from"./Badge-CM23X0aP.js";import{I as p}from"./Input-BZ7duGHL.js";import{M as he}from"./Modal-J_gxoCCM.js";import{C as pe,ab as V,r as ye,S as ge,al as je,_ as Y,aW as Z,ay as D,a7 as T,x as Ne,aX as fe,B as be,am as ve}from"./vendor-icons-B6Rt7gcW.js";import{f as b}from"./vendor-utils-BBD155gO.js";import{f as k}from"./fr-C0qvdQu_.js";import"./vendor-export-C98UG4Mq.js";const J={identifie:{bg:"bg-primary-100",text:"text-primary-600",label:"Identifié"},contacte:{bg:"bg-blue-100",text:"text-blue-600",label:"Contacté"},interesse:{bg:"bg-purple-100",text:"text-purple-600",label:"Intéressé"},negociation:{bg:"bg-warning/20",text:"text-warning",label:"Négociation"},offre_envoyee:{bg:"bg-orange-100",text:"text-orange-600",label:"Offre envoyée"},bail_signe:{bg:"bg-success/20",text:"text-success",label:"Bail signé"},perdu:{bg:"bg-error/20",text:"text-error",label:"Perdu"},en_pause:{bg:"bg-primary-200",text:"text-primary-600",label:"En pause"}},W=["Restauration","Mode & Accessoires","Beauté & Bien-être","Services","Alimentation","Loisirs & Culture","Maison & Déco","High-Tech","Locomotive","Autre"],A=[{id:"1",enseigne:"Carrefour Market",local:"A01",surface:2500,dateDebut:"2025-11-01",dateFinPrevue:"2026-02-15",avancement:75,statut:"en_cours",responsable:"Cabinet AXA"},{id:"2",enseigne:"Zara",local:"B12",surface:850,dateDebut:"2025-12-01",dateFinPrevue:"2026-01-31",avancement:45,statut:"en_cours",responsable:"Entreprise BTP+"},{id:"3",enseigne:"Orange Money",local:"C03",surface:120,dateDebut:"2025-12-15",dateFinPrevue:"2026-01-15",avancement:90,statut:"en_cours",responsable:"Artisan Local"},{id:"4",enseigne:"KFC",local:"D08",surface:280,dateDebut:"2026-01-10",dateFinPrevue:"2026-03-01",avancement:0,statut:"a_demarrer",responsable:"Sodexo Build"},{id:"5",enseigne:"Pharmacie Nouvelle",local:"A15",surface:180,dateDebut:"2025-10-01",dateFinPrevue:"2025-12-15",dateFinReelle:"2025-12-20",avancement:100,statut:"termine",responsable:"PharmaBuild"},{id:"6",enseigne:"Nike",local:"B05",surface:320,dateDebut:"2025-11-15",dateFinPrevue:"2026-01-20",avancement:30,statut:"bloque",responsable:"Sports Fit-Out",notes:"Attente validation plans MOE"}],q=[{id:"1",locataire:"CFAO",nomCommercial:"Carrefour Market",activite:"Alimentation",mixCategorie:"Locomotive",local:"A01",statut:"signé",relocating:!1,gla:2500,pctSurface:25,prixGla:15e3,loyerAnnuel:45e7,loyerBail:45e7,seuilMin:4e8,chargesAnnuelles:45e6,loyerCharges:495e6,encaisseMensuel:375e5,encaisseFinMois:375e5,tauxRecouvrement:100,impaye:0,etatRecouvrement:"ok",lastUpdate:"2026-01-03"},{id:"2",locataire:"INDITEX",nomCommercial:"Zara",activite:"Mode & Accessoires",mixCategorie:"Mode",local:"B12",statut:"signé",relocating:!1,gla:850,pctSurface:8.5,prixGla:18e3,loyerAnnuel:1836e5,loyerBail:1836e5,chargesAnnuelles:255e5,loyerCharges:2091e5,encaisseMensuel:153e5,encaisseFinMois:1224e4,tauxRecouvrement:80,impaye:306e4,etatRecouvrement:"relance",lastUpdate:"2026-01-02",comments:"Relance envoyée le 02/01"},{id:"3",locataire:"ORANGE CI",nomCommercial:"Orange Money",activite:"Services",mixCategorie:"Services",local:"C03",statut:"signé",relocating:!1,gla:120,pctSurface:1.2,prixGla:22e3,loyerAnnuel:3168e4,loyerBail:3168e4,chargesAnnuelles:36e5,loyerCharges:3528e4,encaisseMensuel:264e4,encaisseFinMois:264e4,tauxRecouvrement:100,impaye:0,etatRecouvrement:"ok",lastUpdate:"2026-01-03"},{id:"4",locataire:"YUM BRANDS",nomCommercial:"KFC",activite:"Restauration",mixCategorie:"Food Court",local:"D08",statut:"en_nego",relocating:!1,gla:280,pctSurface:2.8,prixGla:2e4,loyerAnnuel:672e5,loyerBail:672e5,seuilMin:5e7,palier:5,chargesAnnuelles:84e5,loyerCharges:756e5,encaisseMensuel:0,encaisseFinMois:0,tauxRecouvrement:0,impaye:0,etatRecouvrement:"ok",lastUpdate:"2025-12-28",comments:"Signature prévue semaine prochaine"},{id:"5",locataire:"PHARMA+",nomCommercial:"Pharmacie Nouvelle",activite:"Santé",mixCategorie:"Services",local:"A15",statut:"signé",relocating:!1,gla:180,pctSurface:1.8,prixGla:16e3,loyerAnnuel:3456e4,loyerBail:3456e4,chargesAnnuelles:54e5,loyerCharges:3996e4,encaisseMensuel:288e4,encaisseFinMois:288e4,tauxRecouvrement:100,impaye:0,etatRecouvrement:"ok",lastUpdate:"2026-01-03"},{id:"6",locataire:"NIKE INC",nomCommercial:"Nike",activite:"Mode & Accessoires",mixCategorie:"Sport",local:"B05",statut:"signé",relocating:!1,gla:320,pctSurface:3.2,prixGla:17500,loyerAnnuel:672e5,loyerBail:672e5,chargesAnnuelles:96e5,loyerCharges:768e5,encaisseMensuel:56e5,encaisseFinMois:0,tauxRecouvrement:0,impaye:56e5,echeanceProchaine:"2026-01-15",motifEcheance:"Retard travaux",etatRecouvrement:"négociation",lastUpdate:"2026-01-02",comments:"Report loyer jusqu'à ouverture"},{id:"7",locataire:"SEPHORA",nomCommercial:"Sephora",activite:"Beauté & Bien-être",mixCategorie:"Beauté",local:"B08",statut:"signé",relocating:!1,gla:250,pctSurface:2.5,prixGla:19e3,loyerAnnuel:57e6,loyerBail:57e6,chargesAnnuelles:75e5,loyerCharges:645e5,encaisseMensuel:475e4,encaisseFinMois:475e4,tauxRecouvrement:100,impaye:0,etatRecouvrement:"ok",lastUpdate:"2026-01-03"},{id:"8",locataire:"QUICK RST",nomCommercial:"Quick",activite:"Restauration",mixCategorie:"Food Court",local:"D02",statut:"signé",relocating:!1,gla:200,pctSurface:2,prixGla:21e3,loyerAnnuel:504e5,loyerBail:504e5,seuilMin:4e7,chargesAnnuelles:6e6,loyerCharges:564e5,encaisseMensuel:42e5,encaisseFinMois:21e5,tauxRecouvrement:50,impaye:21e5,etatRecouvrement:"relance",lastUpdate:"2026-01-02",comments:"2ème relance"},{id:"9",locataire:"H&M",nomCommercial:"H&M",activite:"Mode & Accessoires",mixCategorie:"Mode",local:"B15",statut:"prospect",relocating:!1,gla:600,pctSurface:6,prixGla:16500,loyerAnnuel:1188e5,loyerBail:0,chargesAnnuelles:18e6,loyerCharges:1368e5,encaisseMensuel:0,encaisseFinMois:0,tauxRecouvrement:0,impaye:0,etatRecouvrement:"ok",lastUpdate:"2025-12-20",comments:"Offre en cours d'analyse"},{id:"10",locataire:"FNAC DARTY",nomCommercial:"Fnac",activite:"High-Tech",mixCategorie:"Loisirs",local:"C10",statut:"en_nego",relocating:!1,gla:450,pctSurface:4.5,prixGla:14e3,loyerAnnuel:756e5,loyerBail:756e5,chargesAnnuelles:135e5,loyerCharges:891e5,encaisseMensuel:0,encaisseFinMois:0,tauxRecouvrement:0,impaye:0,etatRecouvrement:"ok",lastUpdate:"2025-12-30",comments:"Négociation franchise de loyer"}],Ce={a_demarrer:{bg:"bg-primary-100",text:"text-primary-600",label:"À démarrer"},en_cours:{bg:"bg-info/20",text:"text-info",label:"En cours"},termine:{bg:"bg-success/20",text:"text-success",label:"Terminé"},bloque:{bg:"bg-error/20",text:"text-error",label:"Bloqué"}};function we({isOpen:y,onClose:M,prospect:s,projetId:I,onSave:_}){var F,O,m,N;const[r,o]=j.useState({enseigne:(s==null?void 0:s.enseigne)||"",categorie:(s==null?void 0:s.categorie)||"Autre",surface:(s==null?void 0:s.surface)||0,loyerPropose:(s==null?void 0:s.loyerPropose)||0,statut:(s==null?void 0:s.statut)||"identifie",probabilite:(s==null?void 0:s.probabilite)||50,estLocomotive:(s==null?void 0:s.estLocomotive)||!1,dateContact:s!=null&&s.dateContact?b(new Date(s.dateContact),"yyyy-MM-dd"):b(new Date,"yyyy-MM-dd"),contactNom:((F=s==null?void 0:s.contacts[0])==null?void 0:F.nom)||"",contactFonction:((O=s==null?void 0:s.contacts[0])==null?void 0:O.fonction)||"",contactTelephone:((m=s==null?void 0:s.contacts[0])==null?void 0:m.telephone)||"",contactEmail:((N=s==null?void 0:s.contacts[0])==null?void 0:N.email)||""});j.useEffect(()=>{var l,d,v,f;s&&o({enseigne:s.enseigne,categorie:s.categorie,surface:s.surface,loyerPropose:s.loyerPropose,statut:s.statut,probabilite:s.probabilite,estLocomotive:s.estLocomotive,dateContact:b(new Date(s.dateContact),"yyyy-MM-dd"),contactNom:((l=s.contacts[0])==null?void 0:l.nom)||"",contactFonction:((d=s.contacts[0])==null?void 0:d.fonction)||"",contactTelephone:((v=s.contacts[0])==null?void 0:v.telephone)||"",contactEmail:((f=s.contacts[0])==null?void 0:f.email)||""})},[s]);const $=l=>{l.preventDefault();const d=r.contactNom?[{nom:r.contactNom,fonction:r.contactFonction,telephone:r.contactTelephone,email:r.contactEmail}]:[];_({enseigne:r.enseigne,categorie:r.categorie,surface:r.surface,loyerPropose:r.loyerPropose,statut:r.statut,probabilite:r.probabilite,estLocomotive:r.estLocomotive,dateContact:new Date(r.dateContact).toISOString(),contacts:d,historique:(s==null?void 0:s.historique)||[],projetId:I}),M()};return e.jsx(he,{isOpen:y,onClose:M,title:s?"Modifier le prospect":"Nouveau prospect",size:"lg",children:e.jsxs("form",{onSubmit:$,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(p,{label:"Enseigne",value:r.enseigne,onChange:l=>o({...r,enseigne:l.target.value}),placeholder:"Nom de l'enseigne",required:!0}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-primary-700 mb-1.5",children:"Catégorie"}),e.jsx("select",{value:r.categorie,onChange:l=>o({...r,categorie:l.target.value}),className:"w-full px-3 py-2 border border-primary-300 rounded-lg focus:ring-2 focus:ring-primary-500",children:W.map(l=>e.jsx("option",{value:l,children:l},l))})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(p,{label:"Surface (m²)",type:"number",value:r.surface,onChange:l=>o({...r,surface:parseInt(l.target.value)||0}),placeholder:"0"}),e.jsx(p,{label:"Loyer proposé (FCFA/m²)",type:"number",value:r.loyerPropose,onChange:l=>o({...r,loyerPropose:parseInt(l.target.value)||0}),placeholder:"0"}),e.jsx(p,{label:"Probabilité (%)",type:"number",min:0,max:100,value:r.probabilite,onChange:l=>o({...r,probabilite:parseInt(l.target.value)||0})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-primary-700 mb-1.5",children:"Statut"}),e.jsx("select",{value:r.statut,onChange:l=>o({...r,statut:l.target.value}),className:"w-full px-3 py-2 border border-primary-300 rounded-lg focus:ring-2 focus:ring-primary-500",children:Object.entries(J).map(([l,{label:d}])=>e.jsx("option",{value:l,children:d},l))})]}),e.jsx(p,{label:"Date de contact",type:"date",value:r.dateContact,onChange:l=>o({...r,dateContact:l.target.value})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"locomotive",checked:r.estLocomotive,onChange:l=>o({...r,estLocomotive:l.target.checked}),className:"rounded border-primary-300 text-primary-900 focus:ring-primary-500"}),e.jsx("label",{htmlFor:"locomotive",className:"text-sm text-primary-700",children:"Enseigne locomotive (ancrage majeur)"})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("p",{className:"text-sm font-medium text-primary-700 mb-3",children:"Contact principal"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(p,{label:"Nom",value:r.contactNom,onChange:l=>o({...r,contactNom:l.target.value}),placeholder:"Nom du contact"}),e.jsx(p,{label:"Fonction",value:r.contactFonction,onChange:l=>o({...r,contactFonction:l.target.value}),placeholder:"Fonction"}),e.jsx(p,{label:"Téléphone",value:r.contactTelephone,onChange:l=>o({...r,contactTelephone:l.target.value}),placeholder:"+225 XX XX XX XX"}),e.jsx(p,{label:"Email",type:"email",value:r.contactEmail,onChange:l=>o({...r,contactEmail:l.target.value}),placeholder:"email@exemple.com"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[e.jsx(S,{variant:"secondary",onClick:M,type:"button",children:"Annuler"}),e.jsx(S,{type:"submit",leftIcon:e.jsx(ve,{className:"w-4 h-4"}),children:s?"Enregistrer":"Créer"})]})]})})}function Te(){const{centreId:y}=oe(),M=xe(),s=me(t=>t.getCentre(y||"")),{projets:I,prospects:_,suiviBEFA:r,loadProjet:o,addProspect:$,updateProspect:F,deleteProspect:O}=de(),[m,N]=j.useState("pipeline"),[l,d]=j.useState(!1),[v,f]=j.useState(),[X,ee]=j.useState(""),[G,te]=j.useState("all");if(j.useEffect(()=>{y&&o(y)},[y]),!s)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("p",{className:"text-primary-500",children:"Centre non trouvé"})});const P=I.find(t=>t.centreId===y);if(!P)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("p",{className:"text-primary-500",children:"Projet non initialisé"})});const g=_.filter(t=>t.projetId===P.id),L=r.filter(t=>t.projetId===P.id),U=g.filter(t=>{const c=t.enseigne.toLowerCase().includes(X.toLowerCase()),h=G==="all"||t.categorie===G;return c&&h}),se=1e4,H=g.filter(t=>t.statut==="bail_signe").reduce((t,c)=>t+c.surface,0),ae=g.filter(t=>["negociation","offre_envoyee"].includes(t.statut)).reduce((t,c)=>t+c.surface,0),re=g.filter(t=>t.statut==="bail_signe").reduce((t,c)=>t+c.loyerPropose*c.surface,0),u={total:g.length,signes:g.filter(t=>t.statut==="bail_signe").length,enNego:g.filter(t=>["negociation","offre_envoyee"].includes(t.statut)).length,locomotives:g.filter(t=>t.estLocomotive&&t.statut==="bail_signe").length,occupationPourcent:Math.round(H/se*100),befaComplets:L.filter(t=>t.statut==="complet").length,befaTotal:L.length},le=async t=>{v?await F(v.id,t):await $(t),f(void 0)},ie=t=>{f(t),d(!0)},ne=()=>{f(void 0),d(!0)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>M(`/centre/${y}/projet`),className:"p-2 hover:bg-primary-100 rounded-lg transition-colors",children:e.jsx(pe,{className:"w-5 h-5 text-primary-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-primary-900",children:"Commercialisation"}),e.jsx("p",{className:"text-primary-500",children:s.nom})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"flex bg-primary-100 rounded-lg p-1",children:[e.jsx("button",{onClick:()=>N("pipeline"),className:`px-3 py-1.5 text-sm rounded-md transition-colors ${m==="pipeline"?"bg-white shadow text-primary-900":"text-primary-600"}`,children:"Prospects"}),e.jsx("button",{onClick:()=>N("suivi"),className:`px-3 py-1.5 text-sm rounded-md transition-colors ${m==="suivi"?"bg-white shadow text-primary-900":"text-primary-600"}`,children:"Suivi des baux"}),e.jsx("button",{onClick:()=>N("travaux"),className:`px-3 py-1.5 text-sm rounded-md transition-colors ${m==="travaux"?"bg-white shadow text-primary-900":"text-primary-600"}`,children:"Projets en cours"}),e.jsx("button",{onClick:()=>N("befa"),className:`px-3 py-1.5 text-sm rounded-md transition-colors ${m==="befa"?"bg-white shadow text-primary-900":"text-primary-600"}`,children:"BEFA"})]}),e.jsx(S,{onClick:ne,leftIcon:e.jsx(V,{className:"w-4 h-4"}),children:"Nouveau prospect"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:[e.jsx(i,{children:e.jsx(n,{className:"py-4",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-3xl font-bold text-primary-900",children:[u.occupationPourcent,"%"]}),e.jsx("p",{className:"text-xs text-primary-500",children:"Taux d'occupation"}),e.jsx("div",{className:"w-full h-2 bg-primary-100 rounded-full mt-2 overflow-hidden",children:e.jsx("div",{className:"h-full bg-success rounded-full",style:{width:`${u.occupationPourcent}%`}})})]})})}),e.jsx(i,{children:e.jsx(n,{className:"py-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-success",children:H.toLocaleString()}),e.jsx("p",{className:"text-xs text-primary-500",children:"m² signés"})]})})}),e.jsx(i,{children:e.jsx(n,{className:"py-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-warning",children:ae.toLocaleString()}),e.jsx("p",{className:"text-xs text-primary-500",children:"m² en négo"})]})})}),e.jsx(i,{children:e.jsx(n,{className:"py-4",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-2xl font-bold text-primary-900",children:[u.signes,"/",u.total]}),e.jsx("p",{className:"text-xs text-primary-500",children:"Baux signés"})]})})}),e.jsx(i,{children:e.jsx(n,{className:"py-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:u.locomotives}),e.jsx("p",{className:"text-xs text-primary-500",children:"Locomotives"})]})})}),e.jsx(i,{children:e.jsx(n,{className:"py-4",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-lg font-bold text-primary-900",children:[(re/1e6).toFixed(1),"M"]}),e.jsx("p",{className:"text-xs text-primary-500",children:"Loyer mensuel"})]})})})]}),m==="pipeline"&&e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(ye,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-primary-400"}),e.jsx("input",{type:"text",value:X,onChange:t=>ee(t.target.value),placeholder:"Rechercher une enseigne...",className:"w-full pl-10 pr-4 py-2 border border-primary-300 rounded-lg focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("select",{value:G,onChange:t=>te(t.target.value),className:"px-3 py-2 border border-primary-300 rounded-lg",children:[e.jsx("option",{value:"all",children:"Toutes catégories"}),W.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),m==="pipeline"&&e.jsxs(i,{children:[e.jsx(B,{children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs(E,{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"w-5 h-5"}),"Liste des Prospects"]}),e.jsxs("span",{className:"text-sm text-primary-500",children:[U.length," prospect(s)"]})]})}),e.jsx(n,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-xs text-primary-500 border-b bg-primary-50",children:[e.jsx("th",{className:"px-3 py-3 font-medium",children:"Enseigne"}),e.jsx("th",{className:"px-3 py-3 font-medium",children:"Catégorie"}),e.jsx("th",{className:"px-3 py-3 font-medium",children:"Local"}),e.jsx("th",{className:"px-3 py-3 font-medium text-right",children:"Surface (m²)"}),e.jsx("th",{className:"px-3 py-3 font-medium text-right",children:"Loyer/m²"}),e.jsx("th",{className:"px-3 py-3 font-medium text-right",children:"Loyer Annuel"}),e.jsx("th",{className:"px-3 py-3 font-medium",children:"Statut"}),e.jsx("th",{className:"px-3 py-3 font-medium text-center",children:"Probabilité"}),e.jsx("th",{className:"px-3 py-3 font-medium",children:"Locomotive"}),e.jsx("th",{className:"px-3 py-3 font-medium",children:"Contact"}),e.jsx("th",{className:"px-3 py-3 font-medium",children:"Téléphone"}),e.jsx("th",{className:"px-3 py-3 font-medium",children:"Email"}),e.jsx("th",{className:"px-3 py-3 font-medium",children:"Date Contact"}),e.jsx("th",{className:"px-3 py-3 font-medium",children:"Actions"})]})}),e.jsx("tbody",{children:U.length>0?U.map(t=>{var h,C,w;const c=J[t.statut];return e.jsxs("tr",{className:"border-b border-primary-100 hover:bg-primary-50",children:[e.jsx("td",{className:"px-3 py-3 font-medium text-primary-900",children:t.enseigne}),e.jsx("td",{className:"px-3 py-3 text-primary-600",children:t.categorie}),e.jsx("td",{className:"px-3 py-3 font-mono text-primary-600",children:"-"}),e.jsx("td",{className:"px-3 py-3 text-right",children:t.surface.toLocaleString()}),e.jsx("td",{className:"px-3 py-3 text-right",children:t.loyerPropose.toLocaleString()}),e.jsxs("td",{className:"px-3 py-3 text-right font-medium",children:[(t.loyerPropose*t.surface/1e6).toFixed(1),"M"]}),e.jsx("td",{className:"px-3 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${c.bg} ${c.text}`,children:c.label})}),e.jsx("td",{className:"px-3 py-3 text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"w-12 h-2 bg-primary-100 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full ${t.probabilite>=70?"bg-success":t.probabilite>=40?"bg-warning":"bg-error"}`,style:{width:`${t.probabilite}%`}})}),e.jsxs("span",{className:"text-xs",children:[t.probabilite,"%"]})]})}),e.jsx("td",{className:"px-3 py-3 text-center",children:t.estLocomotive?e.jsx(je,{className:"w-4 h-4 text-warning fill-warning mx-auto"}):e.jsx("span",{className:"text-primary-300",children:"-"})}),e.jsx("td",{className:"px-3 py-3 text-primary-600",children:((h=t.contacts[0])==null?void 0:h.nom)||"-"}),e.jsx("td",{className:"px-3 py-3 text-primary-600",children:((C=t.contacts[0])==null?void 0:C.telephone)||"-"}),e.jsx("td",{className:"px-3 py-3 text-primary-600",children:((w=t.contacts[0])==null?void 0:w.email)||"-"}),e.jsx("td",{className:"px-3 py-3 text-primary-500",children:b(new Date(t.dateContact),"dd/MM/yyyy",{locale:k})}),e.jsx("td",{className:"px-3 py-3",children:e.jsx("button",{onClick:()=>ie(t),className:"p-1.5 hover:bg-primary-100 rounded-lg",children:e.jsx(Y,{className:"w-4 h-4 text-primary-500"})})})]},t.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:14,className:"px-3 py-8 text-center text-primary-400",children:'Aucun prospect. Cliquez sur "Nouveau prospect" pour en ajouter.'})})})]})})})]}),m==="befa"&&e.jsx("div",{className:"space-y-4",children:e.jsxs(i,{children:[e.jsx(B,{children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs(E,{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"w-5 h-5"}),"Suivi BEFA & Aménagements"]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-lg font-bold text-primary-900",children:[u.befaComplets,"/",u.befaTotal]}),e.jsx("p",{className:"text-xs text-primary-500",children:"BEFA complets"})]}),e.jsx("div",{className:"w-32 h-2 bg-primary-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-success rounded-full",style:{width:`${u.befaTotal>0?u.befaComplets/u.befaTotal*100:0}%`}})})]})]})}),e.jsx(n,{children:L.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-sm text-primary-500 border-b",children:[e.jsx("th",{className:"pb-3 font-medium",children:"Enseigne"}),e.jsx("th",{className:"pb-3 font-medium",children:"Local"}),e.jsx("th",{className:"pb-3 font-medium",children:"Surface"}),e.jsx("th",{className:"pb-3 font-medium text-center",children:"BEFA"}),e.jsx("th",{className:"pb-3 font-medium text-center",children:"Pilote B"}),e.jsx("th",{className:"pb-3 font-medium text-center",children:"SOCOTEC"}),e.jsx("th",{className:"pb-3 font-medium text-center",children:"Plans"}),e.jsx("th",{className:"pb-3 font-medium",children:"Statut"})]})}),e.jsx("tbody",{children:L.map(t=>e.jsxs("tr",{className:"border-b border-primary-100",children:[e.jsx("td",{className:"py-3 font-medium text-primary-900",children:t.enseigne}),e.jsx("td",{className:"py-3 text-primary-600",children:t.local}),e.jsxs("td",{className:"py-3 text-primary-900",children:[t.surface," m²"]}),e.jsx("td",{className:"py-3 text-center",children:t.befaSigne?e.jsx(D,{className:"w-5 h-5 text-success mx-auto"}):e.jsx(T,{className:"w-5 h-5 text-primary-300 mx-auto"})}),e.jsx("td",{className:"py-3 text-center",children:t.piloteBSigne?e.jsx(D,{className:"w-5 h-5 text-success mx-auto"}):e.jsx(T,{className:"w-5 h-5 text-primary-300 mx-auto"})}),e.jsx("td",{className:"py-3 text-center",children:t.socotecSigne?e.jsx(D,{className:"w-5 h-5 text-success mx-auto"}):e.jsx(T,{className:"w-5 h-5 text-primary-300 mx-auto"})}),e.jsx("td",{className:"py-3 text-center",children:t.plansValidesDefinitif?e.jsx(D,{className:"w-5 h-5 text-success mx-auto"}):t.plansRecus?e.jsx(T,{className:"w-5 h-5 text-warning mx-auto"}):e.jsx(Ne,{className:"w-5 h-5 text-primary-300 mx-auto"})}),e.jsx("td",{className:"py-3",children:e.jsx(ue,{variant:t.statut==="complet"?"success":t.statut==="en_cours"?"info":t.statut==="bloque"?"error":"default",children:t.statut})})]},t.id))})]})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Z,{className:"w-12 h-12 text-primary-300 mx-auto mb-3"}),e.jsx("p",{className:"text-primary-500",children:"Aucun suivi BEFA"}),e.jsx("p",{className:"text-sm text-primary-400 mt-1",children:"Les BEFA seront créés automatiquement lors de la signature des baux"})]})})]})}),m==="travaux"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsx(i,{children:e.jsx(n,{className:"py-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-info",children:A.filter(t=>t.statut==="en_cours").length}),e.jsx("p",{className:"text-xs text-primary-500",children:"En cours"})]})})}),e.jsx(i,{children:e.jsx(n,{className:"py-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-primary-600",children:A.filter(t=>t.statut==="a_demarrer").length}),e.jsx("p",{className:"text-xs text-primary-500",children:"À démarrer"})]})})}),e.jsx(i,{children:e.jsx(n,{className:"py-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-success",children:A.filter(t=>t.statut==="termine").length}),e.jsx("p",{className:"text-xs text-primary-500",children:"Terminés"})]})})}),e.jsx(i,{children:e.jsx(n,{className:"py-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-error",children:A.filter(t=>t.statut==="bloque").length}),e.jsx("p",{className:"text-xs text-primary-500",children:"Bloqués"})]})})})]}),e.jsxs(i,{children:[e.jsx(B,{children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs(E,{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"w-5 h-5"}),"Travaux d'aménagement locataires"]}),e.jsx(S,{variant:"secondary",leftIcon:e.jsx(V,{className:"w-4 h-4"}),children:"Ajouter un projet"})]})}),e.jsx(n,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-sm text-primary-500 border-b",children:[e.jsx("th",{className:"pb-3 font-medium",children:"Enseigne"}),e.jsx("th",{className:"pb-3 font-medium",children:"Local"}),e.jsx("th",{className:"pb-3 font-medium",children:"Surface"}),e.jsx("th",{className:"pb-3 font-medium",children:"Date début"}),e.jsx("th",{className:"pb-3 font-medium",children:"Date fin prévue"}),e.jsx("th",{className:"pb-3 font-medium",children:"Avancement"}),e.jsx("th",{className:"pb-3 font-medium",children:"Responsable"}),e.jsx("th",{className:"pb-3 font-medium",children:"Statut"}),e.jsx("th",{className:"pb-3 font-medium",children:"Actions"})]})}),e.jsx("tbody",{children:A.map(t=>{const c=Ce[t.statut],h=new Date(t.dateFinPrevue)<new Date&&t.statut!=="termine";return e.jsxs("tr",{className:"border-b border-primary-100 hover:bg-primary-50",children:[e.jsx("td",{className:"py-3 font-medium text-primary-900",children:t.enseigne}),e.jsx("td",{className:"py-3 text-primary-600",children:t.local}),e.jsxs("td",{className:"py-3 text-primary-900",children:[t.surface," m²"]}),e.jsx("td",{className:"py-3 text-sm text-primary-600",children:b(new Date(t.dateDebut),"dd MMM yyyy",{locale:k})}),e.jsxs("td",{className:`py-3 text-sm ${h?"text-error font-medium":"text-primary-600"}`,children:[b(new Date(t.dateFinPrevue),"dd MMM yyyy",{locale:k}),h&&e.jsx("span",{className:"ml-1 text-xs",children:"(Retard)"})]}),e.jsx("td",{className:"py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-20 h-2 bg-primary-100 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full ${t.avancement>=75?"bg-success":t.avancement>=40?"bg-warning":"bg-info"}`,style:{width:`${t.avancement}%`}})}),e.jsxs("span",{className:"text-xs text-primary-600",children:[t.avancement,"%"]})]})}),e.jsx("td",{className:"py-3 text-sm text-primary-600",children:t.responsable}),e.jsx("td",{className:"py-3",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${c.bg} ${c.text}`,children:c.label})}),e.jsx("td",{className:"py-3",children:e.jsx("button",{className:"p-1.5 hover:bg-primary-100 rounded-lg",children:e.jsx(Y,{className:"w-4 h-4 text-primary-500"})})})]},t.id)})})]})})})]})]}),m==="suivi"&&(()=>{const t=q.filter(a=>a.statut==="signé"),c=q.reduce((a,x)=>a+x.gla,0),h=t.reduce((a,x)=>a+x.gla,0),C=t.reduce((a,x)=>a+x.loyerAnnuel,0),w=t.reduce((a,x)=>a+x.chargesAnnuelles,0),K=t.reduce((a,x)=>a+x.encaisseFinMois,0),Q=t.reduce((a,x)=>a+x.encaisseMensuel,0),z=t.reduce((a,x)=>a+x.impaye,0),R=Q>0?Math.round(K/Q*100):0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:[e.jsx(i,{children:e.jsx(n,{className:"py-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-primary-900",children:h.toLocaleString()}),e.jsx("p",{className:"text-xs text-primary-500",children:"GLA Signée (m²)"})]})})}),e.jsx(i,{children:e.jsx(n,{className:"py-4",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-2xl font-bold text-success",children:[(C/1e6).toFixed(0),"M"]}),e.jsx("p",{className:"text-xs text-primary-500",children:"Loyer Annuel"})]})})}),e.jsx(i,{children:e.jsx(n,{className:"py-4",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-2xl font-bold text-info",children:[(w/1e6).toFixed(0),"M"]}),e.jsx("p",{className:"text-xs text-primary-500",children:"Charges Annuelles"})]})})}),e.jsx(i,{children:e.jsx(n,{className:"py-4",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:`text-2xl font-bold ${R>=90?"text-success":R>=70?"text-warning":"text-error"}`,children:[R,"%"]}),e.jsx("p",{className:"text-xs text-primary-500",children:"Taux Recouvrement"})]})})}),e.jsx(i,{children:e.jsx(n,{className:"py-4",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-2xl font-bold text-error",children:[(z/1e6).toFixed(1),"M"]}),e.jsx("p",{className:"text-xs text-primary-500",children:"Impayés"})]})})}),e.jsx(i,{children:e.jsx(n,{className:"py-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-primary-900",children:t.length}),e.jsx("p",{className:"text-xs text-primary-500",children:"Baux Actifs"})]})})})]}),e.jsxs(i,{children:[e.jsx(B,{children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs(E,{className:"flex items-center gap-2",children:[e.jsx(be,{className:"w-5 h-5"}),"État Locatif & Suivi Recouvrement"]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(S,{variant:"secondary",size:"sm",children:"Exporter Excel"})})]})}),e.jsx(n,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-xs text-primary-500 border-b bg-primary-50",children:[e.jsx("th",{className:"px-2 py-3 font-medium sticky left-0 bg-primary-50",children:"Locataire"}),e.jsx("th",{className:"px-2 py-3 font-medium",children:"Nom Commercial"}),e.jsx("th",{className:"px-2 py-3 font-medium",children:"Activité"}),e.jsx("th",{className:"px-2 py-3 font-medium",children:"Mix"}),e.jsx("th",{className:"px-2 py-3 font-medium",children:"Local"}),e.jsx("th",{className:"px-2 py-3 font-medium",children:"Statut"}),e.jsx("th",{className:"px-2 py-3 font-medium text-right",children:"GLA"}),e.jsx("th",{className:"px-2 py-3 font-medium text-right",children:"%Surf"}),e.jsx("th",{className:"px-2 py-3 font-medium text-right",children:"Prix/m²"}),e.jsx("th",{className:"px-2 py-3 font-medium text-right",children:"Loyer Annuel"}),e.jsx("th",{className:"px-2 py-3 font-medium text-right",children:"Charges"}),e.jsx("th",{className:"px-2 py-3 font-medium text-right",children:"Loyer+Ch"}),e.jsx("th",{className:"px-2 py-3 font-medium text-right",children:"Enc. Mois"}),e.jsx("th",{className:"px-2 py-3 font-medium text-center",children:"%Rec"}),e.jsx("th",{className:"px-2 py-3 font-medium text-right",children:"Impayé"}),e.jsx("th",{className:"px-2 py-3 font-medium",children:"État Rec."}),e.jsx("th",{className:"px-2 py-3 font-medium",children:"MAJ"}),e.jsx("th",{className:"px-2 py-3 font-medium",children:"Commentaires"})]})}),e.jsx("tbody",{children:q.map(a=>{const x={signé:"bg-success/20 text-success",en_nego:"bg-warning/20 text-warning",prospect:"bg-info/20 text-info",résilié:"bg-error/20 text-error"},ce={ok:"bg-success/20 text-success",relance:"bg-warning/20 text-warning",contentieux:"bg-error/20 text-error",négociation:"bg-purple-100 text-purple-700"};return e.jsxs("tr",{className:"border-b border-primary-100 hover:bg-primary-50",children:[e.jsx("td",{className:"px-2 py-2 font-medium text-primary-900 sticky left-0 bg-white",children:a.locataire}),e.jsx("td",{className:"px-2 py-2 text-primary-700",children:a.nomCommercial}),e.jsx("td",{className:"px-2 py-2 text-primary-600",children:a.activite}),e.jsx("td",{className:"px-2 py-2",children:e.jsx("span",{className:"px-1.5 py-0.5 bg-primary-100 text-primary-600 rounded text-xs",children:a.mixCategorie})}),e.jsx("td",{className:"px-2 py-2 font-mono text-primary-700",children:a.local}),e.jsx("td",{className:"px-2 py-2",children:e.jsx("span",{className:`px-1.5 py-0.5 rounded text-xs font-medium ${x[a.statut]}`,children:a.statut})}),e.jsx("td",{className:"px-2 py-2 text-right font-medium",children:a.gla.toLocaleString()}),e.jsxs("td",{className:"px-2 py-2 text-right text-primary-500",children:[a.pctSurface,"%"]}),e.jsx("td",{className:"px-2 py-2 text-right",children:a.prixGla.toLocaleString()}),e.jsxs("td",{className:"px-2 py-2 text-right font-medium",children:[(a.loyerAnnuel/1e6).toFixed(1),"M"]}),e.jsxs("td",{className:"px-2 py-2 text-right text-primary-500",children:[(a.chargesAnnuelles/1e6).toFixed(1),"M"]}),e.jsxs("td",{className:"px-2 py-2 text-right font-medium",children:[(a.loyerCharges/1e6).toFixed(1),"M"]}),e.jsxs("td",{className:"px-2 py-2 text-right",children:[(a.encaisseFinMois/1e6).toFixed(1),"M"]}),e.jsx("td",{className:"px-2 py-2 text-center",children:e.jsxs("span",{className:`px-1.5 py-0.5 rounded text-xs font-medium ${a.tauxRecouvrement>=100?"bg-success/20 text-success":a.tauxRecouvrement>=80?"bg-warning/20 text-warning":a.tauxRecouvrement>0?"bg-error/20 text-error":"bg-primary-100 text-primary-400"}`,children:[a.tauxRecouvrement,"%"]})}),e.jsx("td",{className:`px-2 py-2 text-right ${a.impaye>0?"text-error font-medium":"text-primary-400"}`,children:a.impaye>0?`${(a.impaye/1e6).toFixed(1)}M`:"-"}),e.jsx("td",{className:"px-2 py-2",children:e.jsx("span",{className:`px-1.5 py-0.5 rounded text-xs font-medium ${ce[a.etatRecouvrement]}`,children:a.etatRecouvrement})}),e.jsx("td",{className:"px-2 py-2 text-xs text-primary-500",children:b(new Date(a.lastUpdate),"dd/MM",{locale:k})}),e.jsx("td",{className:"px-2 py-2 text-xs text-primary-500 max-w-[150px] truncate",title:a.comments,children:a.comments||"-"})]},a.id)})}),e.jsx("tfoot",{className:"bg-primary-100 font-medium",children:e.jsxs("tr",{children:[e.jsx("td",{colSpan:6,className:"px-2 py-2 text-primary-700",children:"TOTAL"}),e.jsx("td",{className:"px-2 py-2 text-right",children:c.toLocaleString()}),e.jsx("td",{className:"px-2 py-2 text-right",children:"100%"}),e.jsx("td",{className:"px-2 py-2"}),e.jsxs("td",{className:"px-2 py-2 text-right",children:[(C/1e6).toFixed(0),"M"]}),e.jsxs("td",{className:"px-2 py-2 text-right",children:[(w/1e6).toFixed(0),"M"]}),e.jsxs("td",{className:"px-2 py-2 text-right",children:[((C+w)/1e6).toFixed(0),"M"]}),e.jsxs("td",{className:"px-2 py-2 text-right",children:[(K/1e6).toFixed(1),"M"]}),e.jsxs("td",{className:"px-2 py-2 text-center",children:[R,"%"]}),e.jsxs("td",{className:"px-2 py-2 text-right text-error",children:[(z/1e6).toFixed(1),"M"]}),e.jsx("td",{colSpan:3})]})})]})})})]})]})})(),e.jsx(we,{isOpen:l,onClose:()=>{d(!1),f(void 0)},prospect:v,projetId:P.id,onSave:le})]})}export{Te as ProjetCommercial};
